<Window x:Class="WpfApp1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Quản lý Người Thi" Height="520" Width="860"
        WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <!-- Hiển thị tooltip lỗi validation -->
        <Style TargetType="TextBox">
            <Setter Property="Margin" Value="0,4,0,4"/>
            <Style.Triggers>
                <Trigger Property="Validation.HasError" Value="True">
                    <Setter Property="ToolTip"
                            Value="{Binding RelativeSource={RelativeSource Self},
                                            Path=(Validation.Errors)[0].ErrorContent}"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="10"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Form nhập -->
        <Border Padding="12" BorderBrush="#DDD" BorderThickness="1" CornerRadius="6">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="220"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="220"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0">
                    <TextBlock Text="Mã người thi (số)" FontWeight="SemiBold"/>
                    <TextBox
                        Text="{Binding Form.MaNguoiThi, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"
                        PreviewTextInput="NumberOnly_PreviewTextInput"/>

                    <TextBlock Text="Họ tên" FontWeight="SemiBold"/>
                    <TextBox
                        Text="{Binding Form.HoTen, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"/>

                    <TextBlock Text="Ngày sinh" FontWeight="SemiBold"/>
                    <DatePicker
                        SelectedDate="{Binding Form.NgaySinh, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"/>
                </StackPanel>

                <StackPanel Grid.Column="2">
                    <TextBlock Text="CCCD (12 chữ số)" FontWeight="SemiBold"/>
                    <TextBox
                        Text="{Binding Form.CCCD, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"
                        MaxLength="12"
                        PreviewTextInput="NumberOnly_PreviewTextInput"/>

                    <TextBlock Text="Số điện thoại (≤ 15)" FontWeight="SemiBold"/>
                    <TextBox
                        Text="{Binding Form.SoDienThoai, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"
                        MaxLength="15"
                        PreviewTextInput="NumberOnly_PreviewTextInput"/>
                </StackPanel>

                <StackPanel Grid.Column="4" VerticalAlignment="Bottom" Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="Thêm mới" Padding="14,6" Command="{Binding CmdThemMoi}"/>
                    <Button Content="Cập nhật" Padding="14,6" Command="{Binding CmdCapNhat}"/>
                    <Button Content="Xóa" Padding="14,6" Command="{Binding CmdXoa}"/>
                    <Button Content="Làm mới" Padding="14,6" Command="{Binding CmdClear}"/>
                </StackPanel>
            </Grid>
        </Border>

        <Grid Grid.Row="2">
            <DataGrid ItemsSource="{Binding DanhSach}" SelectedItem="{Binding Selected}"
                      AutoGenerateColumns="False" IsReadOnly="True"
                      CanUserAddRows="False" CanUserDeleteRows="False"
                      Margin="0,10,0,0">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Mã" Binding="{Binding MaNguoiThi}" Width="80"/>
                    <DataGridTextColumn Header="Họ tên" Binding="{Binding HoTen}" Width="*"/>
                    <DataGridTextColumn Header="Ngày sinh" Binding="{Binding NgaySinh, StringFormat=\{0:dd/MM/yyyy\}}" Width="130"/>
                    <DataGridTextColumn Header="CCCD" Binding="{Binding CCCD}" Width="150"/>
                    <DataGridTextColumn Header="SĐT" Binding="{Binding SoDienThoai}" Width="150"/>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
    </Grid>
</Window>
